!function(e,t){"use strict";function n(n){return t(e.createElement(n))}function o(e,n){var o=t(window).adaptTo("foundation-ui");o.wait(),t.ajax({url:Granite.HTTP.externalize("/bin/wcmcommand"),type:"POST",data:{_charset_:"UTF-8",cmd:"deletePage",path:e,force:n,checkChildren:!0},success:function(){location.reload()},statusCode:{412:function(){o.clearWait(),1===e.length?t.ajax({url:Granite.HTTP.externalize("/bin/wcm/references.json"),type:"GET",data:{_charset_:"UTF-8",path:e[0],predicate:"wcmcontent"},success:function(t){i(e,t.pages.length)}}):i(e)}},error:function(e){o.clearWait(),412!==e.status&&new Coral.Dialog().set({id:"delErrorDialogConf",variant:"error",header:{innerHTML:Granite.I18n.get("Error")},content:{innerHTML:"<p>"+Granite.I18n.get("Failed to delete.")+"</p>"},footer:{innerHTML:'<button is="coral-button" variant="primary" coral-close size="M">'+Granite.I18n.get("Ok")+"</button>"}}).show()}})}function i(e,t){1===e.length?1===t?n=Granite.I18n.get("This item is referenced once."):t>1&&(n=Granite.I18n.get("This item is referenced {0} times.",t)):n=Granite.I18n.get("One or more item(s) are referenced.");var n,i=new Coral.Dialog().set({id:"forceDelDialogConf",variant:"error",header:{innerHTML:Granite.I18n.get("Force Delete")},content:{innerHTML:n},footer:{innerHTML:'<button is="coral-button" coral-close size="M">'+Granite.I18n.get("Cancel")+"</button>"}}),r=i.querySelector("coral-dialog-footer"),a=new Coral.Button().set({label:{innerHTML:Granite.I18n.get("Delete")},variant:"warning"});r.appendChild(a).off("click").on("click",function(){o(e,!0),i.hide()}),i.show()}t(e).on("click",".cq-confadmin-actions-delete-activator",function e(){var i=n("div"),r=n("p").appendTo(i),a=t(".foundation-selections-item");1===a.length?r.text(Granite.I18n.get("You are going to delete the following item:")):r.text(Granite.I18n.get("You are going to delete the following {0} items:",a.length));for(var c=[],l=Math.min(a.length,12),s=0,d=l;s<d;s++){var u=t(a[s]).find(".foundation-collection-item-title").text();c.push(n("b").text(u).prop("outerHTML"))}a.length>l&&c.push("&#8230;"),n("p").html(c.join("<br>")).appendTo(i);var g=t(window).adaptTo("foundation-ui"),f=[],h=t(".foundation-selections-item");h.length&&(h.each(function(){var e=t(this).data("foundation-collection-item-id");f.push(e)}),g.prompt(Granite.I18n.get("Delete"),i.html(),"notice",[{text:Granite.I18n.get("Cancel")},{text:Granite.I18n.get("Delete"),warning:!0,handler:function(){o(f,!1)}}]))})}(document,Granite.$);